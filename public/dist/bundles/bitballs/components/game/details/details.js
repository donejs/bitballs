define("steal-platform@0.0.4#platform",["@loader"],function(t){var e=(t.global,t._nodeRequire),a="object"==typeof process&&"[object process]"==={}.toString.call(process),r="undefined"!=typeof navigator?navigator.userAgent:"",s=/iPhone OS/.test(r),n=/Android/.test(r),o={isNode:a,isiOS:s,isAndroid:n,isCordova:(s||n)&&"file:"===document.location.protocol,isNW:a&&function(){try{return"undefined"!==e("nw.gui")}catch(t){return!1}}()};return o.isDesktopBrowser=!o.isNode&&!o.isCordova&&!o.isNW,o}),define("bitballs@0.4.0#models/youtube",function(t,e,a){var r,s=t("steal-platform");a.exports=function(){return r||(r=new Promise(function(t,e){if(s.isNode)return void e({});window.onYouTubeIframeAPIReady=function(){t(YT)};var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api",document.head.appendChild(a)}))}}),define("bitballs@0.4.0#components/game/details/details.stache!steal-stache@3.0.7#steal-stache",["module","can-stache","can-stache/src/mustache_core","can-view-import@3.0.7#can-view-import","can-stache-bindings@3.1.6#can-stache-bindings"],function(t,e,a){var r=e([{tokenType:"special",args:["^if gamePromise.isRejected"]},{tokenType:"chars",args:["\n\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["row"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t  \t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["col-md-8"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["youtube-container"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t\t"]},{tokenType:"start",args:["div",!0]},{tokenType:"attrStart",args:["id"]},{tokenType:"attrValue",args:["youtube-player"]},{tokenType:"attrEnd",args:["id"]},{tokenType:"end",args:["div",!0]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["col-md-4"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["h3",!1]},{tokenType:"end",args:["h3",!1]},{tokenType:"chars",args:[" "]},{tokenType:"start",args:["a",!1]},{tokenType:"attrStart",args:["href"]},{tokenType:"special",args:["routeUrl (tournamentId=game.tournamentId)"]},{tokenType:"attrEnd",args:["href"]},{tokenType:"end",args:["a",!1]},{tokenType:"special",args:["game.tournament.year"]},{tokenType:"close",args:["a"]},{tokenType:"chars",args:[" - "]},{tokenType:"special",args:["game.round"]},{tokenType:"chars",args:[" - Court "]},{tokenType:"special",args:["game.court"]},{tokenType:"close",args:["h3"]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["p",!1]},{tokenType:"end",args:["p",!1]},{tokenType:"chars",args:["HOME: "]},{tokenType:"special",args:["game.homeTeam.color"]},{tokenType:"chars",args:[" - "]},{tokenType:"special",args:["game.homeTeam.name"]},{tokenType:"close",args:["p"]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["p",!1]},{tokenType:"end",args:["p",!1]},{tokenType:"chars",args:["AWAY: "]},{tokenType:"special",args:["game.awayTeam.color"]},{tokenType:"chars",args:[" - "]},{tokenType:"special",args:["game.awayTeam.name"]},{tokenType:"close",args:["p"]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["p",!1]},{tokenType:"end",args:["p",!1]},{tokenType:"chars",args:["Final Score "]},{tokenType:"special",args:["finalScore.home"]},{tokenType:"chars",args:[" - "]},{tokenType:"special",args:["finalScore.away"]},{tokenType:"close",args:["p"]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["p",!1]},{tokenType:"end",args:["p",!1]},{tokenType:"chars",args:["Current Score "]},{tokenType:"special",args:["currentScore.home"]},{tokenType:"chars",args:[" - "]},{tokenType:"special",args:["currentScore.away"]},{tokenType:"close",args:["p"]},{tokenType:"chars",args:["\n\t        "]},{tokenType:"start",args:["p",!1]},{tokenType:"end",args:["p",!1]},{tokenType:"close",args:["p"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\n\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\n\t"]},{tokenType:"start",args:["table",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["table table-condensed table-hover"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["table",!1]},{tokenType:"chars",args:["\n\t"]},{tokenType:"start",args:["tbody",!1]},{tokenType:"end",args:["tbody",!1]},{tokenType:"special",args:["#each game.teams"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"start",args:["tr",!1]},{tokenType:"end",args:["tr",!1]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["th",!1]},{tokenType:"attrStart",args:["colspan"]},{tokenType:"attrValue",args:["2"]},{tokenType:"attrEnd",args:["colspan"]},{tokenType:"end",args:["th",!1]},{tokenType:"special",args:["color"]},{tokenType:"chars",args:[" - "]},{tokenType:"special",args:["name"]},{tokenType:"close",args:["th"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"close",args:["tr"]},{tokenType:"special",args:["#each players"]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["tr",!1]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["showStatMenuFor(.,%element, %event)"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"end",args:["tr",!1]},{tokenType:"chars",args:["\n\t\t\t\t"]},{tokenType:"start",args:["td",!1]},{tokenType:"end",args:["td",!1]},{tokenType:"special",args:["name"]},{tokenType:"close",args:["td"]},{tokenType:"chars",args:["\n\t\t\t\t"]},{tokenType:"start",args:["td",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["stats-container"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["td",!1]},{tokenType:"special",args:["#each statsForPlayerId(id)"]},{tokenType:"chars",args:["\n\t\t\t\t\t\t"]},{tokenType:"start",args:["span",!1]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["gotoTimeMinus5(time, %event)"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["stat-point stat-"]},{tokenType:"special",args:["type"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["style"]},{tokenType:"attrValue",args:["left: "]},{tokenType:"special",args:["statPercent time"]},{tokenType:"attrValue",args:["%"]},{tokenType:"attrEnd",args:["style"]},{tokenType:"end",args:["span",!1]},{tokenType:"chars",args:["\t\t\t\t\t\t\t"]},{tokenType:"special",args:["type"]},{tokenType:"chars",args:["\n\t\t\t\t\t\t\t"]},{tokenType:"special",args:["#if session.isAdmin "]},{tokenType:"chars",args:["\n\t\t\t\t\t\t\t\t"]},{tokenType:"start",args:["span",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["destroy-btn glyphicon glyphicon-trash"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["deleteStat(., %event)"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"end",args:["span",!1]},{tokenType:"close",args:["span"]},{tokenType:"special",args:["/if"]},{tokenType:"chars",args:["\n\t\t\t\t\t\t"]},{tokenType:"close",args:["span"]},{tokenType:"special",args:["/each"]},{tokenType:"chars",args:["\n\t\t\t\t"]},{tokenType:"close",args:["td"]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"close",args:["tr"]},{tokenType:"special",args:["/each"]},{tokenType:"chars",args:["\n\t"]},{tokenType:"special",args:["/each"]},{tokenType:"chars",args:["\n\t"]},{tokenType:"close",args:["tbody"]},{tokenType:"chars",args:["\n\t"]},{tokenType:"close",args:["table"]},{tokenType:"chars",args:["\n\t"]},{tokenType:"start",args:["div",!0]},{tokenType:"attrStart",args:["id"]},{tokenType:"attrValue",args:["player-pos"]},{tokenType:"attrEnd",args:["id"]},{tokenType:"end",args:["div",!0]},{tokenType:"special",args:["#if stat"]},{tokenType:"chars",args:["\n\n\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["popover fade right in"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["role"]},{tokenType:"attrValue",args:["tooltip"]},{tokenType:"attrEnd",args:["role"]},{tokenType:"attrStart",args:["style"]},{tokenType:"attrValue",args:["display: block;"]},{tokenType:"attrEnd",args:["style"]},{tokenType:"attrStart",args:["id"]},{tokenType:"attrValue",args:["add-stat"]},{tokenType:"attrEnd",args:["id"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["arrow"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["style"]},{tokenType:"attrValue",args:["top: 50%;"]},{tokenType:"attrEnd",args:["style"]},{tokenType:"end",args:["div",!1]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"start",args:["h3",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["popover-title"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["h3",!1]},{tokenType:"chars",args:["Add Stat for "]},{tokenType:"special",args:["stat.player.name"]},{tokenType:"close",args:["h3"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["popover-content"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"start",args:["form",!1]},{tokenType:"attrStart",args:["($submit)"]},{tokenType:"attrValue",args:["createStat(%event)"]},{tokenType:"attrEnd",args:["($submit)"]},{tokenType:"attrStart",args:["action"]},{tokenType:"attrEnd",args:["action"]},{tokenType:"end",args:["form",!1]},{tokenType:"chars",args:["\n\t\t\t\t"]},{tokenType:"start",args:["label",!1]},{tokenType:"attrStart",args:["for"]},{tokenType:"attrValue",args:["stat-type"]},{tokenType:"attrEnd",args:["for"]},{tokenType:"end",args:["label",!1]},{tokenType:"chars",args:["Type"]},{tokenType:"close",args:["label"]},{tokenType:"chars",args:["\n\t\t\t    "]},{tokenType:"start",args:["select",!1]},{tokenType:"attrStart",args:["{($value)}"]},{tokenType:"attrValue",args:["stat.type"]},{tokenType:"attrEnd",args:["{($value)}"]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["form-control"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["id"]},{tokenType:"attrValue",args:["stat-type"]},{tokenType:"attrEnd",args:["id"]},{tokenType:"end",args:["select",!1]},{tokenType:"chars",args:["\n\t\t\t    \t"]},{tokenType:"start",args:["option",!0]},{tokenType:"attrStart",args:["value"]},{tokenType:"attrEnd",args:["value"]},{tokenType:"end",args:["option",!0]},{tokenType:"special",args:["#statTypes"]},{tokenType:"chars",args:["\n\t\t\t    \t\t"]},{tokenType:"start",args:["option",!1]},{tokenType:"attrStart",args:["value"]},{tokenType:"special",args:["name"]},{tokenType:"attrEnd",args:["value"]},{tokenType:"end",args:["option",!1]},{tokenType:"special",args:["name"]},{tokenType:"close",args:["option"]},{tokenType:"special",args:["/statTypes"]},{tokenType:"chars",args:["\n\t\t\t    "]},{tokenType:"close",args:["select"]},{tokenType:"chars",args:["\n\n\t\t\t\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["form-group"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t\t    "]},{tokenType:"start",args:["label",!1]},{tokenType:"attrStart",args:["for"]},{tokenType:"attrValue",args:["stat-time"]},{tokenType:"attrEnd",args:["for"]},{tokenType:"end",args:["label",!1]},{tokenType:"chars",args:["Time (seconds)"]},{tokenType:"close",args:["label"]},{tokenType:"chars",args:["\n\t\t\t\t    "]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["row"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t\t    \t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["col-xs-6"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t\t    \t\t"]},{tokenType:"start",args:["input",!0]},{tokenType:"attrStart",args:["type"]},{tokenType:"attrValue",args:["text"]},{tokenType:"attrEnd",args:["type"]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["form-control"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["id"]},{tokenType:"attrValue",args:["stat-time"]},{tokenType:"attrEnd",args:["id"]},{tokenType:"attrStart",args:["{($value)}"]},{tokenType:"attrValue",args:["stat.time"]},{tokenType:"attrEnd",args:["{($value)}"]},{tokenType:"end",args:["input",!0]},{tokenType:"chars",args:["\n\t\t\t    \t\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t\t\t    \t\t"]},{tokenType:"start",args:["div",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["col-xs-6"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["div",!1]},{tokenType:"chars",args:["\n\t\t\t    \t\t"]},{tokenType:"start",args:["a",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["btn btn-default"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["minusTime(10)"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"end",args:["a",!1]},{tokenType:"chars",args:["-10 s"]},{tokenType:"close",args:["a"]},{tokenType:"chars",args:["\n\t\t\t    \t\t\t"]},{tokenType:"start",args:["a",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["btn btn-default"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["minusTime(2)"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"end",args:["a",!1]},{tokenType:"chars",args:["-2 s"]},{tokenType:"close",args:["a"]},{tokenType:"chars",args:["\n\t\t\t    \t\t\t"]},{tokenType:"start",args:["a",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["btn btn-default"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["addTime(2)"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"end",args:["a",!1]},{tokenType:"chars",args:["+2 s"]},{tokenType:"close",args:["a"]},{tokenType:"chars",args:["\n\t\t\t    \t\t\t"]},{tokenType:"start",args:["a",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["btn btn-default"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["addTime(10)"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"end",args:["a",!1]},{tokenType:"chars",args:["+10 s"]},{tokenType:"close",args:["a"]},{tokenType:"chars",args:["\n\t\t\t    \t\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t\t\t\t    "]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t\t\t\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t\t\t\t"]},{tokenType:"start",args:["button",!1]},{tokenType:"attrStart",args:["type"]},{tokenType:"attrValue",args:["submit"]},{tokenType:"attrEnd",args:["type"]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["btn btn-primary"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"end",args:["button",!1]},{tokenType:"chars",args:["Add"]},{tokenType:"close",args:["button"]},{tokenType:"chars",args:[" "]},{tokenType:"start",args:["a",!1]},{tokenType:"attrStart",args:["class"]},{tokenType:"attrValue",args:["btn btn-default"]},{tokenType:"attrEnd",args:["class"]},{tokenType:"attrStart",args:["($click)"]},{tokenType:"attrValue",args:["removeStat()"]},{tokenType:"attrEnd",args:["($click)"]},{tokenType:"end",args:["a",!1]},{tokenType:"chars",args:["Cancel"]},{tokenType:"close",args:["a"]},{tokenType:"chars",args:["\n\t\t\t"]},{tokenType:"close",args:["form"]},{tokenType:"chars",args:["\n\t\t"]},{tokenType:"close",args:["div"]},{tokenType:"chars",args:["\n\t"]},{tokenType:"close",args:["div"]},{tokenType:"special",args:["/if"]},{tokenType:"chars",args:["\n"]},{tokenType:"special",args:["else"]},{tokenType:"chars",args:["\n\tGame not found."]},{tokenType:"special",args:["/if"]},{tokenType:"chars",args:["\n"]},{tokenType:"done",args:[]}]);return function(e,s,n){var o={module:t};return s instanceof a.Options||(s=new a.Options(s||{})),r(e,s.add(o),n)}}),define("bitballs@0.4.0#components/game/details/details",function(t,e,a){var r=t("can-component"),s=t("can-define/map/"),n=t("can-define/list/"),o=t("bitballs/models/session"),p=t("bitballs/models/game"),y=t("bitballs/models/stat").default,g=t("bitballs/models/youtube"),T=t("steal-platform"),k=t("jquery");t("./details.less!"),t("bootstrap/dist/css/bootstrap.css!"),t("can-route"),e.ViewModel=s.extend("GameDetailsVM",{youtubePlayer:"any",duration:"any",time:"number",session:o,stat:y,get gamePromise(){return p.get({id:this.gameId,withRelated:["stats","tournament","homeTeam.player1","homeTeam.player2","homeTeam.player3","homeTeam.player4","awayTeam.player1","awayTeam.player2","awayTeam.player3","awayTeam.player4"]})},game:{get:function(t,e){this.gamePromise.then(e,function(t){console.log("GAME LOAD ERROR"),console.error(t)})}},statTypes:{value:y.statTypes},get finalScore(){var t=this.game;if(t&&t.stats){var e=this.playerIdToHomeOrAwayMap,a={home:0,away:0};return t.stats.each(function(t){"1P"===t.type&&a[e[t.playerId]]++,"2P"===t.type&&(a[e[t.playerId]]+=2)}),a}},get currentScore(){var t=this.game;if(t&&t.stats){var e=this.playerIdToHomeOrAwayMap,a={home:0,away:0},r=this.time;return t.stats.each(function(t){t.time<=r&&("1P"===t.type&&a[e[t.playerId]]++,"2P"===t.type&&(a[e[t.playerId]]+=2))}),a}},get playerIdToHomeOrAwayMap(){var t=this.game;if(t&&t.homeTeam&&t.awayTeam){for(var e={},a=1;a<=4;a++)e[t.homeTeam["player"+a+"Id"]]="home",e[t.awayTeam["player"+a+"Id"]]="away";return e}},get sortedStatsByPlayerId(){return this.game.sortedStatsByPlayerId()},showStatMenuFor:function(t,e,a){if(this.session&&this.session.isAdmin()){var r=this.youtubePlayer,s=r.getCurrentTime();r.pauseVideo(),this.stat=new y({time:s,playerId:t.id,gameId:this.game.id,player:t})}},createStat:function(t){t.preventDefault();var e=this;this.stat.save(function(){e.stat=null},function(t){e.stat=null})},removeStat:function(){this.stat=null},addTime:function(t){this.stat.time=this.stat.time+t},minusTime:function(t){this.stat.time=this.stat.time-t},gotoTimeMinus5:function(t,e){var a=this.youtubePlayer;a.seekTo&&a.seekTo(t-5,!0),a.playVideo&&a.playVideo(),e&&e.stopPropagation()},deleteStat:function(t,e){window.confirm("Are you sure you want to delete this stat?")&&(t.destroy(),e&&e.stopPropagation())},statPercent:function(t){var e=this.duration;return e?t()/e*100:"0"},statsForPlayerId:function(t){var e=this.sortedStatsByPlayerId;return e?e[t]||new n:new n}}),e.Component=r.extend({tag:"game-details",view:t("./details.stache!"),ViewModel:e.ViewModel,events:{inserted:function(){var t=this;g().then(function(e){t.YT=e}).then(function(){return t.viewModel.gamePromise}).then(function(){if(t.viewModel.game){var e=new t.YT.Player("youtube-player",{height:"390",width:"640",videoId:t.viewModel.game.videoUrl,events:{onReady:t.onPlayerReady.bind(t),onStateChange:t.onPlayerStateChange.bind(t)}});t.viewModel.youtubePlayer=e}}).catch(function(t){T.isNode||setTimeout(function(){throw t},1)})},removed:function(){clearTimeout(this.timeUpdate),this.removedFromDOM=!0},onPlayerReady:function(){if(this.removedFromDOM)return!0;var t=this.scope.youtubePlayer,e=this;t.playVideo();var a=function(){var r=t.getDuration();r?e.viewModel.duration=r:setTimeout(a,100)};a()},onPlayerStateChange:function(t){var e=this.viewModel,a=e.youtubePlayer,r=this,s=function(){var t=a.getCurrentTime();e.stat&&(e.stat.time=t),r.timeUpdate=setTimeout(s,100),r.updatePosition(t)};t.data===r.YT.PlayerState.PLAYING?(this.scope.playing=!0,s()):(this.scope.playing=!1,clearTimeout(this.timeUpdate))},updatePosition:function(t){var e=this.scope.duration;if(e){this.viewModel.time=t;var a=t/e,r=this.element.getElementsByClassName("stats-container"),s=k(r[0]).width(),n=k(r[0]).offset(),o=k(r[r.length-1]).offset().top-n.top+k(r[r.length-1]).height();k("#player-pos").offset({left:n.left+a*s,top:n.top}).height(o)}},"{stat} time":function(){var t=this.scope.stat.time;if("number"==typeof t&&t>=0){var e=this.scope.youtubePlayer,a=e.getCurrentTime();Math.abs(t-a)>2&&e.seekTo(t,!0)}},"{window} resize":function(){var t,e=this.viewModel.youtubePlayer;e.getCurrentTime&&(t=e.getCurrentTime(),this.updatePosition(t))},"{viewModel} stat":function(t,e,a){setTimeout(function(){k("#add-stat").offset(k(".stats-container:first").offset()).show()},0)}}})});